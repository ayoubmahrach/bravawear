document.addEventListener("DOMContentLoaded",function(){!function(){if("IntersectionObserver"in window){const e=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;o(n),t.unobserve(n)}})},{rootMargin:"50px 0px",threshold:.01});document.querySelectorAll("img[data-src]").forEach(t=>{e.observe(t)})}else document.querySelectorAll("img[data-src]").forEach(e=>{o(e)})}();const e=document.querySelector(".order-btn"),t=document.querySelectorAll(".cart-btn, .floating-cart .cart-icon"),n=document.querySelectorAll(".cart-count");function o(e){const t=e.getAttribute("data-src");if(!t)return;const n=new Image;n.onload=function(){e.src=t,e.classList.remove("lazy"),e.classList.add("loaded");const n=e.parentElement.querySelector(".lazy-spinner");n&&n.remove(),console.log("Lazy loaded:",t)},n.onerror=function(){console.error("Failed to load image:",t),e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIG5vdCBmb3VuZDwvdGV4dD48L3N2Zz4="},n.src=t}function i(){return JSON.parse(localStorage.getItem("sp_cart")||"[]")}function r(){const e=i();n.forEach(t=>t.textContent=e.reduce((e,t)=>e+Number(t.qty),0))}function c(){let e=i(),t=document.getElementById("sp-cart-modal");t||(t=document.createElement("div"),t.id="sp-cart-modal",t.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.7);\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                z-index: 10000;\n                backdrop-filter: blur(5px);\n            ",t.innerHTML='\n                <div style="\n                    background: white;\n                    border-radius: 15px;\n                    padding: 30px;\n                    max-width: 500px;\n                    width: 90%;\n                    max-height: 80vh;\n                    overflow-y: auto;\n                    position: relative;\n                ">\n                    <h2 style="margin-bottom: 20px; color: var(--primary-color);">Your Cart</h2>\n                    <div class="sp-cart-items" style="margin-bottom: 20px;"></div>\n                    <div style="display: flex; gap: 10px; justify-content: flex-end;">\n                        <button class="btn outline-btn sp-close-btn" style="padding: 10px 20px;">Close</button>\n                        <button class="btn primary-btn sp-confirm-btn" style="padding: 10px 20px;">Confirm Order</button>\n                    </div>\n                </div>\n            ',document.body.appendChild(t));const n=t.querySelector(".sp-cart-items");0===e.length?n.innerHTML="<p>Your cart is empty.</p>":n.innerHTML=e.map(e=>`\n                <div style="\n                    display: flex;\n                    align-items: center;\n                    padding: 10px;\n                    border-bottom: 1px solid #eee;\n                    margin-bottom: 10px;\n                ">\n                    <img src="${e.img}" alt="${e.title}" style="width:50px;height:50px;object-fit:cover;border-radius:8px;margin-right:10px;">\n                    <div style="flex: 1;">\n                        <strong>${e.title}</strong><br>\n                        <small>Size: ${e.size}, Color: <span style="background:${e.color};padding:0 8px;border-radius:8px;display:inline-block;width:20px;height:20px;"></span></small><br>\n                        <small>Qty: ${e.qty} - ${e.price}</small>\n                    </div>\n                </div>\n            `).join(""),t.style.display="flex",t.querySelector(".sp-close-btn").onclick=()=>{t.style.display="none"},t.onclick=e=>{e.target===t&&(t.style.display="none")},t.querySelector(".sp-confirm-btn").onclick=()=>{t.style.display="none";const e=`https://wa.me/212702209437?text=${encodeURIComponent("Hi! I want to place an order for the items in my cart.")}`;window.open(e,"_blank")}}!function(){const e=document.querySelector(".mobile-menu-toggle"),t=document.querySelector(".mobile-menu"),n=document.querySelector(".mobile-menu-close");e&&t&&e.addEventListener("click",function(){console.log("Mobile menu toggled"),t.classList.toggle("open"),document.body.style.overflow=t.classList.contains("open")?"hidden":""}),n&&t&&n.addEventListener("click",function(){console.log("Mobile menu closed"),t.classList.remove("open"),document.body.style.overflow=""})}(),e&&e.addEventListener("click",function(e){e.preventDefault();const t=function(){const e=document.querySelector(".product-title")?.textContent?.trim()||"Product",t=document.querySelector(".price-value")?.textContent?.trim()||"0",n=document.querySelector(".color-btn.active"),o=n?n.style.backgroundColor:"",i=document.querySelector(".size-btn.active");return{title:e,price:t,color:o,size:i?i.textContent.trim():"",qty:document.querySelector(".quantity-input")?.value||1,img:document.querySelector(".main-image img")?.src||""}}();let n=i();const o=n.findIndex(e=>e.title===t.title&&e.color===t.color&&e.size===t.size);o>-1?n[o].qty=Number(n[o].qty)+Number(t.qty):n.push(t),function(e){localStorage.setItem("sp_cart",JSON.stringify(e))}(n),r(),c()}),t.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),c()})}),r(),function(){const e=document.querySelectorAll(".tab-btn"),t=document.querySelectorAll(".tab-pane");e.length&&t.length&&e.forEach(n=>{n.addEventListener("click",function(){e.forEach(e=>e.classList.remove("active")),t.forEach(e=>e.classList.remove("active")),this.classList.add("active");const n=this.getAttribute("data-tab"),o=document.getElementById(n);o&&o.classList.add("active")})})}(),function(){const e=document.getElementById("minThumb"),t=document.getElementById("maxThumb"),n=document.getElementById("minPrice"),o=document.getElementById("maxPrice"),i=document.querySelector(".price-slider-track"),r=document.querySelector(".price-slider-container");if(!(e&&t&&n&&o&&i&&r))return;let c=!1,l=null;function s(){const r=parseInt(n.value)/500*100,c=parseInt(o.value)/500*100;i.style.left=`${r}%`,i.style.width=c-r+"%",e.style.left=`${r}%`,t.style.left=`${c}%`}function a(e,t){let i=parseInt(e.value);if(i=Math.min(500,Math.max(0,i)),e.value=i,t){i>parseInt(o.value)&&(o.value=i)}else{const e=parseInt(n.value);i<e&&(n.value=e)}s()}function d(e,t){c=!0,l=t,document.addEventListener("mousemove",u),document.addEventListener("mouseup",m)}function u(t){if(!c||!l)return;const i=r.getBoundingClientRect();let a=(t.clientX-i.left)/i.width;a=Math.min(1,Math.max(0,a));const d=Math.round(500*a);if(l===e){d<=parseInt(o.value)&&(n.value=d)}else{d>=parseInt(n.value)&&(o.value=d)}s()}function m(){c=!1,l=null,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m)}n.addEventListener("input",()=>a(n,!0)),o.addEventListener("input",()=>a(o,!1)),e.addEventListener("mousedown",t=>d(0,e)),t.addEventListener("mousedown",e=>d(0,t)),s()}()});